package main

import (
	"log"
	"math/rand"
	"mysql-test/db"
	"mysql-test/models"
	"runtime/debug"
	"strings"
	"time"
)

func main() {
	db.InitMysql()
	start := time.Now()
	for i := 0; i < 5000000; i++ {
		addRequestLogs, err := generateRequest()
		if err != nil {
			return
		}
		err = insertRequest(addRequestLogs)
		if err != nil {
			return
		}
		log.Println(i)
	}
	log.Println("耗时：", time.Since(start))
}

func generateRequest() (models.AddRequestLogs, error) {
	addRequestLogs := models.AddRequestLogs{
		Path:    randWord(),
		Payload: randJsonString(5, 15),
		Header:  randJsonString(3, 10),
	}
	return addRequestLogs, nil

}

func insertRequest(record models.AddRequestLogs) error {
	err := models.NewRequestLogs().AddRecord(&record)
	if err != nil {
		log.Println(debug.Stack(), err)
		return err
	}

	return nil
}

func randWord() string {
	sentence := `today i shed my old skin which hath too long suffered the bruises of failure and the wounds of mediority today i am born anew and my birthplace is a vineyard where there is fruit for alltoday i will pluck grapes of wisdom from the tallest and fullest vines in the vineyardfor these were planted by the wisest of my profession who have come before megeneration upon generationtoday i will savor the taste of grapes from these vines and verily i will swallow the seed of success buried in each and new life will sprout within methe career i have chosen is laden with opportunity yet it is fraught with heartbreak and despair and the bodies of those who have failed were they piled one atop another would cast a shadow down upon all the pyramids of the earthyet i will not fail as the others for in my hands i now hold the charts which will guide through perilous waters to shores which only yesterday seemed but a dreamfailure no longer will be my payment for struggle just as nature made no provision for my body to tolerate pain neither has it made any provision for my life to suffer failure failure like pain is alien to my life in the past i accepted it as i accepted pain now i reject it and i am prepared for wisdom and principles which will guide me out of the shadows into the sunlight of wealth position and happiness far beyond my most extravagant dreams until even the golden apples in the garden of hesperides will seem no more than my just rewardtime teaches all things to him who lives forever but i have not the luxury of eternity yet within my allotted time i must practice the art of patience for nature acts never in haste to create the olive king of all trees a hundred years is required an onion plant is old in nine weeks i have lived as an onion plant it has not pleased me now i wouldst become the greatest of olive trees and in truth the greatest of salesmanand how will this be accomplished for i have neither the knowledge nor the experience to achieve the greatness and already i have stumbled in ignorance and fallen into pools of self-pity the answer is simple i will commence my journey unencumbered with either the weight of unnecessary knowledge or the handicap of meaningless experience nature already has supplied me with knowledge and instinct far greater than any beast in the forest and the value of experience is overrated usually by old men who nod wisely and speak stupidlyin truth experience teaches thoroughly yet her course of instruction devours men's years so the value of her lessons diminishes with the time necessary to acquire her special wisdom the end finds it wasted on dead men furthermore experience is comparable to fashion an action that proved successful today will be unworkable and impractical tomorrowonly principles endure and these i now possess for the laws that will lead me to greatness are contained in the words of these scrolls what they will teach me is more to prevent failure than to gain success for what is success other than a state of mind which two among a thouand wise men will define success in the same words yet failure is always described but one way failure is man's inability to reach his goals in life whatever they may bein truth the only difference between those who have failed and those who have successed lies in the difference of their habits good habits are the key to all success bad habits are the unlocked door to failure thus the first law i will obey which precedeth all others is i will form good habits and become their slaveas a child i was slave to my impulses now i am slave to my habits as are all grown men i have surrendered my free will to the years of accumulated habits and the past deeds of my life have already marked out a path which threatens to imprison my future my actions are ruled by appetite passion prejudice greed love fear environment habit and the worst of these tyrants is habit therefore if i must be a slave to habit let me be a slave to good habits my bad habits must be destroyed and new furrows prepared for good seedi will form good habits and become their slaveand how will i accomplish this difficult feat through these scrolls it will be done for each scroll contains a principle which will drive a bad habit from my life and replace it with one which will bring me closer to success for it is another of nature's laws that only a habit can subdue another habit so in order for these written words to perform their chosen task i must discipline myself with the first of my new habits which is as follows:i will read each scroll for thirty days in this prescribed manner before i proceed to the next scrollfirst i will read the words in silence when i arise then i will read the words in silence after i have partaken of my midday meal last i will read the words again just before i retire at day's end and most important on this occasion i will read the words aloudon the next day i will repeat this procedure and i will continue in like manner for thirty days then i will turn to the next scroll and repeat this procedure for another thirty days i will continue in this manner until i have lived with each scroll for thirty days and my reading has become habitand what will be accomplished with this habit herein lies the hidden secret of all man's accomplishments as i repeat the words daily they will soon become a part of my active mind but more important they will also seep into my other mind that mysterious source which never sleeps which creates my dreams and often makes me act in ways i do not comprehendas the words of these scrolls are consumed by my mysterious mind i will begin to awake each morning with a vitality i have never known before my vigor will increase my enthusiasm will rise my desire to meet the world will overcome every fear i once knew at sunrise and i will be happier than i ever believed it possible to be in this world of strife and sorroweventually i will find myself reacting to all situations which confront me as i was commanded in the scrolls to react and soon these actions and reactions will become easy to perform for any act with practice becomes easythus a new and good habit is born for when an act becomes easy through constant repetiton it becomes a pleasure to perform and if it is a pleasure to perform it is man's nature to perform it often when i perform it often it becomes a habit and i become its slave and since it is a good habit this is my willtoday i begin a new lifeand i make a solemn oath to myself that nothing will retard my new life's growth i will lose not a day from these readings for that day cannot be retrieved nor can i substitute another for it i must not  i will not break this habit of daily reading from these scrolls and in truth the few moments spent each day on this new habit are but a small price to pay for the happiness and success that will be mineas i read and re-read the words in the scrolls to follow never will i allow the brevity of each scroll nor the simplicity of its words to cause me to treat the scroll's message lightly thousands of grapes are pressed to fill one jar with wine and the grapeskin and pulp are tossed to the birds so it is with these grapes of wisdom from the ages much has been filtered and tossed to the windonly the pure truth lies distilled in the words to come i will drink as instructed and spill not a drop and the seed of success i will swallowtoday my old skin has become as dust i will walk tall among men and they will know me not  for today i am a new man with a new life riding on the ceaseless rushing torrent of life i should pursue and overtake it so as to create an even greater and deeper torrent of my ownif i were a lamp it would be my duty to light up thick darkness if i were the sea tide i would marshal rolling waves to cleanse the beach of all accumulated filththis quotation reflects aptly the state of mind of a lighterfighters are badly needed in our time but such fighters do not necessarily go to the battle- field gun in hand their weapons are not necessarily bullets their weapons may be knowledge faith and strong will they can bring the enemy sure death without drawing his blooda fighter is always in pursuit of light instead of basking in the sunshine under a clear sky he holds a burning torch in the darkness of night to illuminate people's way so that they can continue their journey till they see the dawn of a new day it is the task of a fighter to dispel darkness instead of shirking darkness he braves it and fights the hidden demons and monsters therein he is determined to wipe them out and win light he knows no compromise he will keep on fighting until he wins lighta fighter is perennially young he is never irresolute or inactive he plunges deep into teeming crowds in search of such vermin as flies and venomous mosquitoes he will fight them relentlessly and refuse to coexist with them under the same sky to him life means nothing but continuous fighting he either survives by winning light or perishes with his body covered all over with cuts and bruises in the course of the struggle it is the future that serves as the beacon light to him the future gives people hope and inspiration he will never lose his youthful vigoura fighter will never lose heart or despair he will pile up broken pieces of brick and stone to rebuild a nine-story pagoda on the ruins of failure no blows will ever break his will he will never close his eyes until he has breathed his lasta fighter is always fearless his steps are firm once he has settled on an objective he will press right ahead he is never afraid of being tripped by a stumbling block no obstacles will ever make him change his mind his eyes will never be hoodwinked by false appearances his actions are guided by faith he can endure any hardships or sufferings while striving to attain his chosen objective he will never abandon work as long as he is alivethis is the kind of fighter we now need he is not necessarily possessed of superhuman capability he is just an ordinary person anyone can be a fighter so long as he has the determination hence a few words of mine about being a fighter to encourage those young people who wander about in a depressed state not knowing which way to go life is like a big swing dangling between the depths of happiness and sadness as soon as we descend down the slope of sadness we accelerate over the ever-feel-good acclivity f happiness at times of distress when we are down we slip over an abyss of emotional trauma and frustrations one who can rise above the occasion is the architect of many wins over sorrowsto come above tougher times you have to pep yourself up when you are feeling low lost and confused this can be done effectively by self-talk self-talk is a way of talking to oneself it can be effectively used for soul searching when talking to ourselves we hardly lie as our conscience controls our speech self talk is efficient because when we are vocal about our thoughts it makes a larger impact on our mind our brain then receives the same message from the mind as well as the ears this repetition pep talks and thoughts fine tunes the performance of brainself-talk is a software which when properly loaded onto our mind directs ourselves for better results and a healthy mind actually many times in our life we find others advising us to do better in studies sports life etc we usually get bugged by these people and blank our ears out of their constructive suggestions it is because it doesn't come from within us and when something comes from within you you always try your best to do justice to it self-talk can thus ameliorate our statuseach one of us has some good points and some bad ones though we hardly admit in pubic we know in our mind that we could do better in some areas of our personal landscape this get better attitude can be converted into a practical reality using self-talkif you are an introvert and you want to be the gregarious person like you friend next door all you need to do is talk to yourself tell yourself with all the sincerity and emotions that i can be like him i am a natural born speaker i do like people and speaking comes naturally to me i just have to be ready to listen and speak suppose you love a person and want to tell him or her then just say to yourselves i love her with all my heart she is the only one and i know it if i don't let her know it would be grave injustice on my part every person loves to be loved even she will these are just some examples i have explained it's up to you to program your own mantra`
	wordsSlice := strings.Split(sentence, " ")
	min := 1
	max := len(wordsSlice)

	rand.Seed(time.Now().UnixNano())
	randInt := 1
	if min >= max || min == 0 || max == 0 {
		randInt = max
	}
	randInt = rand.Intn(max-min) + min
	randStr := wordsSlice[randInt]

	return randStr
}

func randJsonString(minLen, maxLen int) string {
	sentence := `today i shed my old skin which hath too long suffered the bruises of failure and the wounds of mediority today i am born anew and my birthplace is a vineyard where there is fruit for alltoday i will pluck grapes of wisdom from the tallest and fullest vines in the vineyardfor these were planted by the wisest of my profession who have come before megeneration upon generationtoday i will savor the taste of grapes from these vines and verily i will swallow the seed of success buried in each and new life will sprout within methe career i have chosen is laden with opportunity yet it is fraught with heartbreak and despair and the bodies of those who have failed were they piled one atop another would cast a shadow down upon all the pyramids of the earthyet i will not fail as the others for in my hands i now hold the charts which will guide through perilous waters to shores which only yesterday seemed but a dreamfailure no longer will be my payment for struggle just as nature made no provision for my body to tolerate pain neither has it made any provision for my life to suffer failure failure like pain is alien to my life in the past i accepted it as i accepted pain now i reject it and i am prepared for wisdom and principles which will guide me out of the shadows into the sunlight of wealth position and happiness far beyond my most extravagant dreams until even the golden apples in the garden of hesperides will seem no more than my just rewardtime teaches all things to him who lives forever but i have not the luxury of eternity yet within my allotted time i must practice the art of patience for nature acts never in haste to create the olive king of all trees a hundred years is required an onion plant is old in nine weeks i have lived as an onion plant it has not pleased me now i wouldst become the greatest of olive trees and in truth the greatest of salesmanand how will this be accomplished for i have neither the knowledge nor the experience to achieve the greatness and already i have stumbled in ignorance and fallen into pools of self-pity the answer is simple i will commence my journey unencumbered with either the weight of unnecessary knowledge or the handicap of meaningless experience nature already has supplied me with knowledge and instinct far greater than any beast in the forest and the value of experience is overrated usually by old men who nod wisely and speak stupidlyin truth experience teaches thoroughly yet her course of instruction devours men's years so the value of her lessons diminishes with the time necessary to acquire her special wisdom the end finds it wasted on dead men furthermore experience is comparable to fashion an action that proved successful today will be unworkable and impractical tomorrowonly principles endure and these i now possess for the laws that will lead me to greatness are contained in the words of these scrolls what they will teach me is more to prevent failure than to gain success for what is success other than a state of mind which two among a thouand wise men will define success in the same words yet failure is always described but one way failure is man's inability to reach his goals in life whatever they may bein truth the only difference between those who have failed and those who have successed lies in the difference of their habits good habits are the key to all success bad habits are the unlocked door to failure thus the first law i will obey which precedeth all others is i will form good habits and become their slaveas a child i was slave to my impulses now i am slave to my habits as are all grown men i have surrendered my free will to the years of accumulated habits and the past deeds of my life have already marked out a path which threatens to imprison my future my actions are ruled by appetite passion prejudice greed love fear environment habit and the worst of these tyrants is habit therefore if i must be a slave to habit let me be a slave to good habits my bad habits must be destroyed and new furrows prepared for good seedi will form good habits and become their slaveand how will i accomplish this difficult feat through these scrolls it will be done for each scroll contains a principle which will drive a bad habit from my life and replace it with one which will bring me closer to success for it is another of nature's laws that only a habit can subdue another habit so in order for these written words to perform their chosen task i must discipline myself with the first of my new habits which is as follows:i will read each scroll for thirty days in this prescribed manner before i proceed to the next scrollfirst i will read the words in silence when i arise then i will read the words in silence after i have partaken of my midday meal last i will read the words again just before i retire at day's end and most important on this occasion i will read the words aloudon the next day i will repeat this procedure and i will continue in like manner for thirty days then i will turn to the next scroll and repeat this procedure for another thirty days i will continue in this manner until i have lived with each scroll for thirty days and my reading has become habitand what will be accomplished with this habit herein lies the hidden secret of all man's accomplishments as i repeat the words daily they will soon become a part of my active mind but more important they will also seep into my other mind that mysterious source which never sleeps which creates my dreams and often makes me act in ways i do not comprehendas the words of these scrolls are consumed by my mysterious mind i will begin to awake each morning with a vitality i have never known before my vigor will increase my enthusiasm will rise my desire to meet the world will overcome every fear i once knew at sunrise and i will be happier than i ever believed it possible to be in this world of strife and sorroweventually i will find myself reacting to all situations which confront me as i was commanded in the scrolls to react and soon these actions and reactions will become easy to perform for any act with practice becomes easythus a new and good habit is born for when an act becomes easy through constant repetiton it becomes a pleasure to perform and if it is a pleasure to perform it is man's nature to perform it often when i perform it often it becomes a habit and i become its slave and since it is a good habit this is my willtoday i begin a new lifeand i make a solemn oath to myself that nothing will retard my new life's growth i will lose not a day from these readings for that day cannot be retrieved nor can i substitute another for it i must not  i will not break this habit of daily reading from these scrolls and in truth the few moments spent each day on this new habit are but a small price to pay for the happiness and success that will be mineas i read and re-read the words in the scrolls to follow never will i allow the brevity of each scroll nor the simplicity of its words to cause me to treat the scroll's message lightly thousands of grapes are pressed to fill one jar with wine and the grapeskin and pulp are tossed to the birds so it is with these grapes of wisdom from the ages much has been filtered and tossed to the windonly the pure truth lies distilled in the words to come i will drink as instructed and spill not a drop and the seed of success i will swallowtoday my old skin has become as dust i will walk tall among men and they will know me not  for today i am a new man with a new life riding on the ceaseless rushing torrent of life i should pursue and overtake it so as to create an even greater and deeper torrent of my ownif i were a lamp it would be my duty to light up thick darkness if i were the sea tide i would marshal rolling waves to cleanse the beach of all accumulated filththis quotation reflects aptly the state of mind of a lighterfighters are badly needed in our time but such fighters do not necessarily go to the battle- field gun in hand their weapons are not necessarily bullets their weapons may be knowledge faith and strong will they can bring the enemy sure death without drawing his blooda fighter is always in pursuit of light instead of basking in the sunshine under a clear sky he holds a burning torch in the darkness of night to illuminate people's way so that they can continue their journey till they see the dawn of a new day it is the task of a fighter to dispel darkness instead of shirking darkness he braves it and fights the hidden demons and monsters therein he is determined to wipe them out and win light he knows no compromise he will keep on fighting until he wins lighta fighter is perennially young he is never irresolute or inactive he plunges deep into teeming crowds in search of such vermin as flies and venomous mosquitoes he will fight them relentlessly and refuse to coexist with them under the same sky to him life means nothing but continuous fighting he either survives by winning light or perishes with his body covered all over with cuts and bruises in the course of the struggle it is the future that serves as the beacon light to him the future gives people hope and inspiration he will never lose his youthful vigoura fighter will never lose heart or despair he will pile up broken pieces of brick and stone to rebuild a nine-story pagoda on the ruins of failure no blows will ever break his will he will never close his eyes until he has breathed his lasta fighter is always fearless his steps are firm once he has settled on an objective he will press right ahead he is never afraid of being tripped by a stumbling block no obstacles will ever make him change his mind his eyes will never be hoodwinked by false appearances his actions are guided by faith he can endure any hardships or sufferings while striving to attain his chosen objective he will never abandon work as long as he is alivethis is the kind of fighter we now need he is not necessarily possessed of superhuman capability he is just an ordinary person anyone can be a fighter so long as he has the determination hence a few words of mine about being a fighter to encourage those young people who wander about in a depressed state not knowing which way to go life is like a big swing dangling between the depths of happiness and sadness as soon as we descend down the slope of sadness we accelerate over the ever-feel-good acclivity f happiness at times of distress when we are down we slip over an abyss of emotional trauma and frustrations one who can rise above the occasion is the architect of many wins over sorrowsto come above tougher times you have to pep yourself up when you are feeling low lost and confused this can be done effectively by self-talk self-talk is a way of talking to oneself it can be effectively used for soul searching when talking to ourselves we hardly lie as our conscience controls our speech self talk is efficient because when we are vocal about our thoughts it makes a larger impact on our mind our brain then receives the same message from the mind as well as the ears this repetition pep talks and thoughts fine tunes the performance of brainself-talk is a software which when properly loaded onto our mind directs ourselves for better results and a healthy mind actually many times in our life we find others advising us to do better in studies sports life etc we usually get bugged by these people and blank our ears out of their constructive suggestions it is because it doesn't come from within us and when something comes from within you you always try your best to do justice to it self-talk can thus ameliorate our statuseach one of us has some good points and some bad ones though we hardly admit in pubic we know in our mind that we could do better in some areas of our personal landscape this get better attitude can be converted into a practical reality using self-talkif you are an introvert and you want to be the gregarious person like you friend next door all you need to do is talk to yourself tell yourself with all the sincerity and emotions that i can be like him i am a natural born speaker i do like people and speaking comes naturally to me i just have to be ready to listen and speak suppose you love a person and want to tell him or her then just say to yourselves i love her with all my heart she is the only one and i know it if i don't let her know it would be grave injustice on my part every person loves to be loved even she will these are just some examples i have explained it's up to you to program your own mantra`
	wordsSlice := strings.Split(sentence, " ")
	min := 1
	max := len(wordsSlice)

	randLen := 1
	if minLen >= maxLen || minLen == 0 || maxLen == 0 {
		randLen = maxLen
	}
	rand.Seed(time.Now().UnixNano())
	randLen = rand.Intn(maxLen-minLen+1) + minLen

	randStr := `{`
	for i := 0; i < randLen; i++ {
		randInt := 1
		if min >= max || min == 0 || max == 0 {
			randInt = max
		}
		randInt = rand.Intn(max-min) + min
		randInt2 := rand.Intn(max-min) + min
		randStr += `"` + wordsSlice[randInt] + `":` + `"` + wordsSlice[randInt2] + `",`
	}
	randStr = strings.Trim(randStr, ",")
	randStr += "}"
	return randStr
}
